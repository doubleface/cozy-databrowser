{"version":3,"sources":["app/application.js","app/initialize.js","app/models/menu.js","app/views/main.js","app/views/menu.js"],"names":["Router","Backbone","extend","routes","onDoctype","doctype","app","views","main","setDoctype","menu","select","initialize","$el","appendTo","router","history","start","$","on","$aside","isExpanded","attr","window","Collection","model","Model","url","attrToString","_","isObject","result","i","View","el","collection","listenTo","render","getCols","json","length","push","title","data","defaultContent","html","toJSON","config","destroy","lengthChange","dom","buttons","scrollX","scrollY","deferRender","scroller","columns","DataTable","fetch","reset","done","bind","itemTemplate","template","forEach","sclass","selected","empty","removeClass","addClass"],"mappings":"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","file":"public/javascripts/app.js","sourcesContent":["import MenuView from \"views/menu\";\nimport MainView from \"views/main\";\n\nvar Router = Backbone.Router.extend({\n    routes: {\n        \"doctype/:doctype\": \"onDoctype\"\n    },\n    onDoctype(doctype){\n        this.app.views.main.setDoctype(doctype);\n        this.app.views.menu.select(doctype);\n    }\n});\n\nvar app = {\n    initialize() {\n        this.views = {\n            menu: new MenuView(),\n            main: new MainView()\n        };\n        this.views.menu.$el.appendTo(\"#container\");\n        this.views.main.$el.appendTo(\"#container\");\n        this.router = new Router({\n            app: this\n        });\n        this.router.app = this;\n        Backbone.history.start();\n\n        $(\"[formaction='drawer/toggle']\").on(\"click\", () => {\n            const $aside = $(\"aside\")\n            const isExpanded = $aside.attr(\"aria-expanded\") === \"true\" ? \"false\" : \"true\";\n            $aside.attr(\"aria-expanded\", isExpanded);\n        });\n    }\n}\n\nvar router = new Router();\n\nexport default app\n\n","import app from \"application\";\n\nwindow.app = app;\n\n$(() => app.initialize());\n","export default Backbone.Collection.extend({\n    model: Backbone.Model,\n    url: \"doctypes\"\n});\n","function attrToString(attr) {\n    if (!_(attr).isObject()) return attr;\n    else {\n        let result = '<ul>';\n        for (let i in attr) {\n            result+= `<li>${attrToString(attr[i])}</li>`;\n        }\n        result+= '</ul>';\n        return result;\n    }\n}\n\nexport default Backbone.View.extend({\n    el: \"[role='contentinfo']\",\n    collection: new Backbone.Collection(),\n    initialize() {\n        this.listenTo(this.collection, \"reset\", this.render);\n    },\n    getCols(json) {\n        var result = [];\n        if (json.length === 0) return result;\n        for (var i in json[0]) {\n            result.push({\n                title: i,\n                data: i,\n                defaultContent: \"\"\n            });\n        }\n        return result;\n    },\n    render() {\n        this.$el.html('<table></table>');\n        var json = this.collection.toJSON();\n        var config = {\n            destroy: true,\n            lengthChange: false,\n            dom: '<\"thead\"Bfi>t',\n            buttons: [\n                'colvis'\n            ],\n            scrollX: \"100%\",\n            scrollY: \"calc(100vh - 7em)\",\n            deferRender: true,\n            scroller: true,\n            data: json,\n            columns: this.getCols(json)\n        };\n        this.$(\"table\").DataTable(config);\n        return this;\n    },\n    setDoctype(doctype){\n        this.doctype = doctype;\n        this.collection.fetch({\n            reset: true,\n            url: \"search?range=all&doctypes[]=\" + doctype\n        });\n    }\n});\n","import Collection from \"models/menu\";\n\nexport default Backbone.View.extend({\n    el: \"aside\",\n    collection: new Collection(),\n    initialize() {\n        this.collection.fetch().done(this.render.bind(this));\n    },\n    itemTemplate: _.template('<li><a class=\"<%= sclass %>\" href=\"#doctype/<%= doctype %>\"><%= doctype %> (<%= sum %>)</a></li>'),\n    render() {\n        var html = \"<ul>\";\n        this.collection.forEach((model) => {\n            var json = model.toJSON();\n            json.sclass = json.doctype === this.selected ? \"selected\" : \"\";\n            html+= this.itemTemplate(json);\n        }, this);\n        html+= \"</ul>\";\n        this.$el.empty().html(html);\n        return this;\n    },\n    select(doctype) {\n        this.selected = doctype;\n        this.$(\"a\").removeClass(\"selected\");\n        this.$(\"a[href='#doctype/\" + doctype + \"']\").addClass(\"selected\");\n    }\n});\n"]}